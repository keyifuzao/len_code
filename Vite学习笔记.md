# Vite

## 一、什么是构建工具

1、`typescript`：如果我们遇到`ts`文件我们需要使用`tsc`将`typescript`代码转换为`js`代码

2、`React/Vue`：安装`react-compiler/ vue-complier` ，将我们写的`jsx`文件或者`vue`文件转换为`render`函数

3、`less/sass/postcss/component-style`：我们有需要安装`less-loader`，`sass-loader`等一些列编译工具

4、语法降级：`babel` ---> 将`es`的新语法转换旧版浏览器可以接受的语法

5、体积优化：`uglifyjs`  ---> 将我们的代码进行压缩，变成体积更小性能更高的文件

6、...

稍微改一点点东西，非常麻烦



将`App.tsx`  => `tsc` => `App.jsx` => `React-complier` => `js`文件

有一个东西能够帮你把`tsc`，`react-complier`，`less`，`babel`， `uglifyjs`全部集成到一起，这个就叫做构建工具



打包：将我们写的浏览器不认识的代码，交给构建工具进行编译处理的过程就叫做打包，打包完成以后会给我们一个浏览器可以认识的文件



构建工具都做什么工作？

1、模块化开发支持：支持直接从`node_modules`里引入代码 + 多种模块化

2、处理代码兼容性：比如`babel`语法降级，`less`，`ts`语法转换（不是构建工具做的，构建工具将这些语法对应的处理工具集成进来，进行自动化处理）

3、提高项目性能：构建工具会自动监听文件的变化，当文件变化以后自动帮你调用对应的集成工具进行打包，然后在浏览器重新运行（整个过程叫做热更新，`hot replacement`）

​	开发服务器：跨域的问题，用`react-cli` `create-react-element` `vue-cli` 解决跨域问题



> [!TIP]
>
> 构建工具他让我们可以不用每次都关心我们的代码在浏览器如何运行，我们只需要首次给构建工具提供一个配置文件（这个配置文件也不是必须的，如果你不给他，他会默认的帮你去处理），有了这个集成的配置文件，我们就可以在下次需要更新的时候调用一次对应的命令就好了，如果我们再结合热更新，我们就更加不需要管任何东西，这就是构建工具去做的事情
>
> **他让我们不用关心生产的代码也不用关心代码如何在浏览器运行，只需要关系我们的开发怎么写的爽怎么写就好了**



市面上主流的构建工具有哪些？

> `webpack`、`vite`、`parcel`、`esbuild`、`rollup`、`grunt`、`gulp`

## 二、`vite`的优势

我们项目越大，构建工具索要处理的`js`代码就越多（跟`webpack`的一个构建过程（工作流程）有关系），构建工具需要很长时间才能启动开发服务器

`vite`会不会把`webpack`干翻，`vite`是基于`es modules`的，侧重点不一样，`webpack`更多关注兼容性，`vite`关注浏览器端的开发体验

## 三、vite脚手架和vite

比如我们输入```yarn create vite```

1、帮我们全局安装了一个东西：`create-vite`（`vite`的脚手架）

2、直接运行这个`create-vite` `bin`目录下的一个执行配置



我们之前接触过`vue-cli`

很多同学可能存在误区，**认为官网中使用对应`yarn create`构建项目过程也是`vite`在做的事情**



`create-vite`和`vite`的关系是什么呢？`create-vite`内置了`vite`

使用`vue-cli`会内置`webpack`





一、`vite`环境变量

环境变量：会根据当前的代码环境产生值的变化的变量就叫做环境变量

代码变量：

​	1、开发环境

​	2、测试环境

​	3、预发布环境

​	4、灰度环境

​	5、生产环境



举个例子：百度地图`sdk`

`APP_KEY`: 测试环境和生产还有开发环境式不一样的`key`

- 开发环境：`110`
- 生产环境：`111`
- 测试环境：`112`



在vite中环境变量处理

vite内置了dotenv这个第三方库，会自动读取.env文件，并解析这个文件中的对应环境变量，并将其注入到process对象下 

补充一个小知识，为什么vite.config.js可以书写成esmodule的形式，这是因为vite他在读取这个vite.config.js时候会率先去解析文件语法，如果发现你是esmodule规范会直接将你的esmodule规范进行替换变成commonjs规范